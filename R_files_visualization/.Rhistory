f <- file.choose()
df <- read.csv(f, , stringsAsFactors=T, header = TRUE, sep=",")
#FILTRAR DATOS SARS-CoV-2 EN VARIABLE resultado_definitivo
library(dplyr)
df2 <- df %>%
mutate(fecha_de_registro = as.Date(fecha_de_registro)) %>%
filter(resultado_definitivo == "SARS-CoV-2", rango_de_edad != "", fecha_de_registro >= 2020-01-01)%>%
droplevels()
library(ggplot2)
df2$evolucion_caso
levels(df2$evolucion_caso) <-c("RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "ACTIVOS GRAVES", "ACTIVOS GRAVES", "ACTIVOS", "DEFUNCION", "ACTIVOS", "ACTIVOS", "ACTIVOS", "RECUPERADOS")
ggplot(df2, aes(x=rango_de_edad, y=diabetes)) +
geom_bar(stat = "count", data=df2[df2$diabetes=="SI",], mapping = aes(y = (..count..)), fill="#154360") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: DIABETES")
ggplot(df2, aes(x=rango_de_edad, y=epoc)) +
geom_bar(stat = "count", data=df2[df2$epoc=="SI",], mapping = aes(y = (..count..)), fill="#B9770E") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: EPOC")
ggplot(df2, aes(x=rango_de_edad, y=asma)) +
geom_bar(stat = "count", data=df2[df2$asma=="SI",], mapping = aes(y = (..count..)), fill="#58D68D") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: ASMA")
ggplot(df2, aes(x=rango_de_edad, y=inmunosupresivo)) +
geom_bar(stat = "count", data=df2[df2$inmunosupresivo =="SI",], mapping = aes(y = (..count..)), fill="#C39BD3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: INMUNSUPRESIVO")
ggplot(df2, aes(x=rango_de_edad, y=insuficiencia_renal_cronica)) +
geom_bar(stat = "count", data=df2[df2$insuficiencia_renal_cronica =="SI",], mapping = aes(y = (..count..)), fill="#A8B627") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: INSUFICIENCIA RENAL CRONICA")
f <- file.choose()
df <- read.csv(f, , stringsAsFactors=T, header = TRUE, sep=",")
df2 <- df %>%
mutate(fecha_de_registro = as.Date(fecha_de_registro)) %>%
filter(resultado_definitivo == "SARS-CoV-2", rango_de_edad != "", fecha_de_registro >= 2020-01-01)%>%
droplevels()
df2$evolucion_caso
levels(df2$evolucion_caso) <-c("RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "ACTIVOS GRAVES", "ACTIVOS GRAVES", "ACTIVOS LEVES", "DEFUNCION", "ACTIVOS LEVES", "ACTIVOS LEVES", "ACTIVOS LEVES", "RECUPERADOS")
percentData <- df2 %>% group_by(evolucion_caso) %>% count(sexo) %>%
mutate(ratio=scales::percent(n/sum(n)))
library(ggplot2)
ggplot(data=df2, aes(x=evolucion_caso, fill=sexo)) +
geom_bar() +
geom_text(data=percentData, aes(y=n,label=ratio), position=position_stack(0.5), size=3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
df2$evolucion_caso
levels(df2$evolucion_caso)
f <- file.choose()
df <- read.csv(f, , stringsAsFactors=T, header = TRUE, sep=",")
#FILTRAR DATOS SARS-CoV-2 EN VARIABLE resultado_definitivo
library(dplyr)
df2 <- df %>%
mutate(fecha_de_registro = as.Date(fecha_de_registro)) %>%
filter(resultado_definitivo == "SARS-CoV-2", rango_de_edad != "", fecha_de_registro >= 2020-01-01)%>%
droplevels()
df2$evolucion_caso
levels(df2$evolucion_caso) <-c("RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "ACTIVOS GRAVES", "ACTIVOS GRAVES", "ACTIVOS", "DEFUNCION", "ACTIVOS", "ACTIVOS", "ACTIVOS", "RECUPERADOS")
levels(df2$evolucion_caso)
df2 <- df %>%
mutate(fecha_de_registro = as.Date(fecha_de_registro)) %>%
filter(resultado_definitivo == "SARS-CoV-2", rango_de_edad != "", fecha_de_registro >= 2020-01-01)%>%
droplevels()
#EXPLORACION DE DATOS
class(df)
head(df)
str(df)
summary(df)
#EXPLORACION DE DATOS
class(df)
head(df)
str(df)
summary(df)
levels(df$evolucion_caso)
levels(df2$evolucion_caso)
df2$evolucion_caso
levels(df2$evolucion_caso) <-c("RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "RECUPERADOS", "ACTIVOS GRAVES", "ACTIVOS GRAVES", "ACTIVOS LEVES", "FALLECIDOS", "ACTIVOS LEVES", "ACTIVOS LEVES", "ACTIVOS LEVES", "RECUPERADOS")
levels(df2$evolucion_caso)
percentData <- df2 %>% group_by(evolucion_caso) %>% count(sexo) %>%
mutate(ratio=scales::percent(n/sum(n)))
library(ggplot2)
ggplot(data=df2, aes(x=evolucion_caso, fill=sexo)) +
geom_bar() +
geom_text(data=percentData, aes(y=n,label=ratio), position=position_stack(0.5), size=3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
percentData2 <- df2 %>% group_by(evolucion_caso) %>% count(evolucion_caso)
percentData2
percentData3 <- df2 %>% group_by(evolucion_caso,rango_de_edad) %>% count(sexo) %>%
mutate(ratio=scales::percent(n/sum(n)))
ggplot(df2, aes(x=rango_de_edad, y=sexo, fill=sexo)) +
geom_bar(stat = "count", data=df2[df2$sexo=="MASCULINO",], mapping = aes(y = (..count..))) +
geom_text(data=percentData3[percentData3$sexo=="MASCULINO",], aes(y = n, label = ratio), size = 2.5, position = position_fill(vjust = 0.5), hjust = -0.3) +
geom_bar(stat = "count", df2[df2$sexo=="FEMENINO",], mapping = aes(y= -(..count..))) +
geom_text(data=percentData3[percentData3$sexo=="FEMENINO",], aes(y = -n, label = ratio), size = 2.5, position = position_fill(vjust = 0.5), hjust = 1.3)+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
scale_y_continuous(label= abs) +
coord_flip() +
theme(text = element_text(size=10))+
labs(y="Porcentaje", x="Edad") +
ggtitle("EVOLUCION DEL CASO")
ggplot(df2, aes(x=rango_de_edad, y=sexo, fill=sexo)) +
geom_bar(stat = "count", data=df2[df2$sexo=="MASCULINO",], mapping = aes(y = (..count..))) +
geom_text(data=percentData3[percentData3$sexo=="MASCULINO",], aes(y = n, label = ratio), size = 2.5, position = position_fill(vjust = 0.5), hjust = -0.3) +
geom_bar(stat = "count", df2[df2$sexo=="FEMENINO",], mapping = aes(y= -(..count..))) +
geom_text(data=percentData3[percentData3$sexo=="FEMENINO",], aes(y = -n, label = ratio), size = 2.5, position = position_fill(vjust = 0.5), hjust = 1.3)+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
scale_y_continuous(label= abs) +
coord_flip() +
theme(text = element_text(size=10))+
labs(y="Porcentaje", x="Rango de Edad") +
ggtitle("EVOLUCION DEL CASO")
ggplot(df2, aes(x=rango_de_edad, y=diabetes)) +
geom_bar(stat = "count", data=df2[df2$diabetes=="SI",], mapping = aes(y = (..count..)), fill="#154360") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: DIABETES")
ggplot(df2, aes(x=rango_de_edad, y=epoc)) +
geom_bar(stat = "count", data=df2[df2$epoc=="SI",], mapping = aes(y = (..count..)), fill="#B9770E") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: EPOC")
ggplot(df2, aes(x=rango_de_edad, y=asma)) +
geom_bar(stat = "count", data=df2[df2$asma=="SI",], mapping = aes(y = (..count..)), fill="#58D68D") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: ASMA")
ggplot(df2, aes(x=rango_de_edad, y=inmunosupresivo)) +
geom_bar(stat = "count", data=df2[df2$inmunosupresivo =="SI",], mapping = aes(y = (..count..)), fill="#C39BD3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: INMUNSUPRESIVO")
ggplot(df2, aes(x=rango_de_edad, y=hipertension)) +
geom_bar(stat = "count", data=df2[df2$hipertension =="SI",], mapping = aes(y = (..count..)), fill="#F7DC6F") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: HIPERTENSION")
ggplot(df2, aes(x=rango_de_edad, y=VIH_SIDA)) +
geom_bar(stat = "count", data=df2[df2$VIH_SIDA =="SI",], mapping = aes(y = (..count..)), fill="#45B39D") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: VIH_SIDA")
ggplot(df2, aes(x=rango_de_edad, y=enfermedad_cardiaca)) +
geom_bar(stat = "count", data=df2[df2$enfermedad_cardiaca =="SI",], mapping = aes(y = (..count..)), fill="#FF007F") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: ENFERMEDAD CARDIACA")
ggplot(data=df_obesidad , aes(x=rango_de_edad, y=n)) +
geom_bar(stat="identity", fill="#EC7063")+
geom_text(aes(label=ratio), vjust=-0.9, color="black", size=3)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("OBESIDAD")
ggplot(df2, aes(x=rango_de_edad, y=obesidad)) +
geom_bar(stat = "count", data=df2[df2$obesidad =="SI",], mapping = aes(y = (..count..)), fill="#EC7063") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: ENFERMEDAD OBESIDAD")
ggplot(df2, aes(x=rango_de_edad, y=insuficiencia_renal_cronica)) +
geom_bar(stat = "count", data=df2[df2$insuficiencia_renal_cronica =="SI",], mapping = aes(y = (..count..)), fill="#A8B627") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: INSUFICIENCIA RENAL CRONICA")
ggplot(df2, aes(x=rango_de_edad, y=tabaquismo)) +
geom_bar(stat = "count", data=df2[df2$tabaquismo =="SI",], mapping = aes(y = (..count..)), fill="#D2B4DE") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: TABAQUISMO")
install.packages("tidyr")
library("tidyr")
install.packages("tidyr")
#Agrupamos las columnas de patologías bajo una misma variable "patologias"
df3 <- df2 %>%
pivot_longer(cols = 51:61, names_to = "patologias") %>%
filter(value == "SI")%>%
mutate(patologias = forcats::fct_relevel(patologias,"hipertension", "obesidad","diabetes","tabaquismo","enfermedad_cardiaca","asma","insuficiencia_renal_cronica","epoc","otra_condicion", "inmunosupresivo","VIH_SIDA"))
ggplot(data=df3, aes(y=evolucion_caso, x=rango_de_edad, fill = patologias)) +
geom_bar(stat="count", data=df3[df3$evolucion_caso == "RECUPERADOS",], mapping = aes(y = (..count..))) +
facet_wrap(~patologias, ncol = 2) +
theme(text = element_text(size=12))+
labs(y="Casos", x="")+
ggtitle("Distribución de los RECUPERADOS") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=df3, aes(y=evolucion_caso, x=rango_de_edad, fill = patologias)) +
geom_bar(stat="count", data=df3[df3$evolucion_caso == "DEFUNCION",], mapping = aes(y = (..count..))) +
facet_wrap(~patologias, ncol = 2) +
theme(text = element_text(size=13))+
ggtitle("Distribución de los DEFUNCION") +
labs(y="Casos", x="")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=df3, aes(y=evolucion_caso, x=rango_de_edad, fill = patologias)) +
geom_bar(stat="count", data=df3[df3$evolucion_caso == "FALLECIDOS",], mapping = aes(y = (..count..))) +
facet_wrap(~patologias, ncol = 2) +
theme(text = element_text(size=13))+
ggtitle("Distribución de los FALLECIDOS") +
labs(y="Casos", x="")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=df3, aes(y=evolucion_caso, x=rango_de_edad, fill = patologias)) +
geom_bar(stat="count", data=df3[df3$evolucion_caso == "ACTIVOS GRAVES",], mapping = aes(y = (..count..))) +
facet_wrap(~patologias, ncol = 2) +
theme(text = element_text(size=11))+
ggtitle("Distribución de los ACTIVOS GRAVES") +
labs(y="Casos", x="")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=df3, aes(y=evolucion_caso, x=rango_de_edad, fill = patologias)) +
geom_bar(stat="count", data=df3[df3$evolucion_caso == "ACTIVOS",], mapping = aes(y = (..count..))) +
facet_wrap(~patologias, ncol = 2) +
theme(text = element_text(size=11))+
ggtitle("Distribución de los ACTIVOS") +
labs(y="Casos", x="")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=df3, aes(y=evolucion_caso, x=rango_de_edad, fill = patologias)) +
geom_bar(stat="count", data=df3[df3$evolucion_caso == "ACTIVOS LEVES",], mapping = aes(y = (..count..))) +
facet_wrap(~patologias, ncol = 2) +
theme(text = element_text(size=11))+
ggtitle("Distribución de los ACTIVOS LEVES") +
labs(y="Casos", x="")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(scales)
PatologiasRecuperados <- df3 %>%
filter(evolucion_caso == "RECUPERADOS")%>%
droplevels()
PatologiasREC<- PatologiasRecuperados %>%count(patologias) %>%
mutate(ratio=scales::percent(n/sum(n), round(2)))
PatologiasREC
ggplot(PatologiasREC, aes(x=reorder(patologias,-n),y=n,label=ratio,fill=patologias)) +
geom_bar(stat='identity') +
geom_text(data=PatologiasREC, aes(y=n,label=ratio), position=position_stack(0.5), size=3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
PatologiasDefuncion <- df3 %>%
filter(evolucion_caso == "FALLECIDOS")%>%
droplevels()
PatologiasDEF<- PatologiasDefuncion %>%count(patologias) %>%
mutate(ratio=scales::percent(n/sum(n), round(2)))
ggplot(PatologiasDEF, aes(x=reorder(patologias,-n),y=n,label=ratio,fill=patologias)) +
geom_bar(stat='identity') +
geom_text(data=PatologiasDEF, aes(y=n,label=ratio), position=position_stack(0.5), size=3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(df2, aes(x=rango_de_edad, y=obesidad)) +
geom_bar(stat = "count", data=df2[df2$fiebre =="SI",], mapping = aes(y = (..count..)), fill="#EC7063") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: Fiebre")
ggplot(data=df2, aes(x=evolucion_caso, fill=sexo)) +
geom_bar() +
geom_text(data=percentData, aes(y=n,label=ratio), position=position_stack(0.5), size=3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(df2, aes(x=rango_de_edad, y=obesidad)) +
geom_bar(stat = "count", data=df2[df2$fiebre =="SI",], mapping = aes(y = (..count..)), fill="#EC7063") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: Fiebre")
ggplot(df2, aes(x=rango_de_edad y = rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#EC7063") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: Fiebre")
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#EC7063") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: Fiebre")
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#708090") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("DISTRIBUCION DE LOS CASOS POR EDAD Y ESTADO)
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#708090") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("DISTRIBUCION DE LOS CASOS POR EDAD Y ESTADO)
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#708090") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("DISTRIBUCION DE LOS CASOS POR EDAD Y ESTADO")
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#EC7063") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("EVOLUCION DEL CASO: Fiebre")
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#EC7063") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("DISTRIBUCION DE LOS CASOS POR EDAD")
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#B0C4DE") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("DISTRIBUCION DE LOS CASOS POR EDAD")
ggplot(df2, aes(x=rango_de_edad)) +
geom_bar(stat = "count", data=df2, mapping = aes(y = (..count..)), fill="#5F9EA0") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_hline(yintercept=0, colour="white", lwd=1) +
facet_wrap(~evolucion_caso, ncol = 2)+
labs(y="Casos", x="Edad")+
theme(text = element_text(size=13))+
ggtitle("DISTRIBUCION DE LOS CASOS POR EDAD")
